const QUIZ = [
  { question: "Ты заходишь в старую таверну, где чад костров стелется по низкому потолку, а хозяин, сгорбленный и усталый, ставит перед тобой три блюда. Первое — прозрачный овощной суп, лёгкий, словно дыхание лесного ветра. Второе — мясное рагу, густое, острое, дымное, пробуждающее кровь и возбуждающее аппетит. Третье — пережаренный кусок мяса, жирный и тяжёлый, рядом кувшин тёмного эля, пахнущий горечью и забвением.", answers:[
    {text:"Ты выбираешь суп и ешь медленно, чувствуя благодарность за простое благо.", guna:"sat", value:2},
    {text:"Ты тянешься к рагу, ведь оно бодрит тело и придаёт решимости.", guna:"raj", value:1},
    {text:"Ты берёшь самый тяжёлый кусок, заливаешь элем и чувствуешь, как мир уходит в туман.", guna:"tam", value:3},
  ]},
  { question: "На пыльной дороге, под ветвями яблони, ты находишь корзину, полную свежих плодов. Солнце садится, воздух тих, и вокруг никого. Корзина словно зовёт тебя принять решение.", answers:[
    {text:"Ты решаешь найти хозяина и вернуть корзину, даже если это займёт ночь.", guna:"sat", value:3},
    {text:"Ты берёшь несколько яблок, чтобы утолить голод, и оставляешь остальное.", guna:"raj", value:1},
    {text:"Ты забираешь всё и бросаешь пустую корзину в пыль.", guna:"tam", value:2},
  ]},
  { question: "На ярмарочной площади, среди шума, купец в спешке вручает тебе кошель с лишними монетами. Его глаза сияют радостью, он и не замечает ошибки.", answers:[
    {text:"Ты тут же возвращаешь деньги и чувствуешь тепло в сердце.", guna:"sat", value:2},
    {text:"Ты оставляешь лишнее при себе, считая, что удача благоволит тебе.", guna:"raj", value:1},
    {text:"Ты прячешь кошель и думаешь, как урвать ещё, пока никто не заметил.", guna:"tam", value:3},
  ]},
  { question: "В лавке старый хозяин ошибается и кладёт тебе лишний хлеб. Его руки дрожат, глаза усталые, но он улыбается тебе с доверием.", answers:[
    {text:"Ты возвращаешь хлеб и тихо благодаришь за честность судьбы.", guna:"sat", value:2},
    {text:"Ты оставляешь, думая: «Ничего страшного, он не обеднеет..", guna:"raj", value:1},
    {text:"Ты требуешь ещё, убеждая, что он недодал.", guna:"tam", value:3},
  ]},
  { question: "Ты встречаешь путника с тяжёлой ношей. Пот стекает по его лицу, он едва держится на ногах.", answers:[
    {text:"Ты предлагаешь помощь, даже если сам устал.", guna:"sat", value:2},
    {text:"Ты идёшь рядом, намекая на награду за услугу.", guna:"raj", value:1},
    {text:"Ты смеёшься над ним и проходишь мимо, наслаждаясь его страданием.", guna:"tam", value:2},
  ]},
  { question: "В тёмной таверне вспыхивает драка. Люди хватают кружки и ножи, крики гремят над столами.", answers:[
    {text:"Ты пытаешься разнять дерущихся, рискуя собой ради мира.", guna:"sat", value:2},
    {text:"Ты стоишь в стороне, готовый встать на ту сторону, что окажется сильнее.", guna:"raj", value:1},
    {text:"Ты подливаешь масла в огонь, выкрикивая оскорбления, и жаждешь хаоса.", guna:"tam", value:3},
  ]},
  { question: "В очереди к торговцу тебя толкают и грубо обзывают. Люди смотрят, ожидая твоей реакции.", answers:[
    {text:"Ты промолчишь и сохранёшь внутренний покой.", guna:"sat", value:1},
    {text:"Ты отвечаешь резко, отстаивая себя.", guna:"raj", value:2},
    {text:"Ты хватаешь обидчика и начинаешь драку, не думая о последствиях.", guna:"tam", value:3},
  ]},
  { question: "В старом сундуке ты находишь амулет, мерцающий странным светом. Он обещает власть, но его энергия тревожна.", answers:[
    {text:"Ты хранишь его лишь ради защиты других, не думая о собственной выгоде.", guna:"sat", value:3},
    {text:"Ты носишь его, чтобы твой авторитет казался весомее.", guna:"raj", value:1},
    {text:"Ты начинаешь угрожать амулетом окружающим, наслаждаясь страхом.", guna:"tam", value:2},
  ]},
  { question: "Ночью, когда город спит, над небом вспыхивает комета. Толпа сбегается, одни молятся, другие кричат.", answers:[
    {text:"Ты смотришь на светило и размышляешь о смысле существования, словно это знак для пробуждения души.", guna:"sat", value:2},
    {text:"Ты думаешь, как событие можно обратить в свою пользу — устроить торг, напугать людей и заработать.", guna:"raj", value:1},
    {text:"Ты поднимаешь руки к небу и кричишь: «Всем конец!», разжигая страх и хаос.", guna:"tam", value:3},
  ]},
    { question: "В городском переулке седой старец рассказывает тебе путаную притчу. Его слова нелогичны, образы сбивчивы, но в голосе — искренность.", answers:[
    {text:"Ты вслушиваешься в каждое слово, ищешь скрытый смысл и терпеливо открываешь сердце.", guna:"sat", value:2},
    {text:"Ты подхватываешь часть притчи и используешь её для своих дел, вырывая выгоду из сказанного.", guna:"raj", value:1},
    {text:"Ты перебиваешь старца и громко смеёшься: «Что за бред старика!»", guna:"tam", value:2},
  ]},
  { question: "На обочине дороги валяется пьяный. Его лицо в грязи, дыхание тяжёлое. Люди обходят стороной.", answers:[
    {text:"Ты поднимаешь его и доводишь до дома или безопасного места.", guna:"sat", value:2},
    {text:"Ты отворачиваешься и идёшь дальше, делая вид, что ничего не заметил.", guna:"raj", value:0},
    {text:"Ты зовёшь друзей и, смеясь, снимаешь его на потеху.", guna:"tam", value:3},
  ]},
  { question: "Вечером у костра тебя просят рассказать историю, чтобы все слушали.", answers:[
    {text:"Ты начинаешь тихо говорить о добре, вдохновляешь на милосердие и единство.", guna:"sat", value:2},
    {text:"Ты рассказываешь о своих подвигах и победах, подчёркивая силу и ловкость.", guna:"raj", value:1},
    {text:"Ты пускаешься в похабные шутки и грязные байки, вызывая грубый смех.", guna:"tam", value:2},
  ]},
  { question: "Твой друг просит помощи в переезде. На улице жара, у тебя свои дела, но он смотрит с надеждой.", answers:[
    {text:"Ты соглашаешься, даже если сам устанешь, и несёшь его груз.", guna:"sat", value:3},
    {text:"Ты помогаешь только если дорога и дела совпадают с твоими.", guna:"raj", value:1},
    {text:"Ты придумываешь оправдание и уходишь, избегая труда.", guna:"tam", value:2},
  ]},
  { question: "Ты стоишь перед тремя дверями, и каждая манит своим сиянием.", answers:[
    {text:"За первой — светлая комната, где ждут мудрецы и звучит тишина знаний.", guna:"sat", value:3},
    {text:"За второй — зал пиршеств, золото, власть и овации толпы.", guna:"raj", value:2},
    {text:"За третьей — тьма, где скрываются тайны и опасные обещания.", guna:"tam", value:2},
  ]},
  { question: "На обочине умирающий просит воды. Его губы потрескались, глаза молят.", answers:[
    {text:"Ты отдаёшь свою последнюю флягу, не задумываясь.", guna:"sat", value:3},
    {text:"Ты думаешь: «Что получу взамен?», и лишь после даёшь немного.", guna:"raj", value:1},
    {text:"Ты смеёшься, отворачиваешься и уходишь.", guna:"tam", value:3},
  ]},
  { question: "Странник предлагает тебе быстрый успех: деньги, власть, признание — без усилий.", answers:[
    {text:"Ты отказываешься: слишком сладкая приманка ведёт в сети.", guna:"sat", value:2},
    {text:"Ты соглашаешься, если риск кажется минимальным.", guna:"raj", value:2},
    {text:"Ты хватаешься за предложение, хвастаешься, теряешь себя в жадности.", guna:"tam", value:3},
  ]},
  { question: "Ты держишь в руках последнюю свечу в ночи, когда буря гасит огни города. Вдруг встречаешь путника, чей путь в темноте смертельно опасен.", answers:[
    {text:"Ты отдаёшь свечу, оставаясь сам во тьме, но зная, что спас жизнь другому.", guna:"sat", value:2},
    {text:"Ты продаёшь свечу, назначив цену в отчаянии.", guna:"raj", value:1},
    {text:"Ты ломаешь свечу и бросаешь в грязь, забавляясь тем, как он спотыкается в темноте.", guna:"tam", value:3},
  ]},
  { question: "На площади толпа глумится над слабым нищим, кидая камни и обидные слова. Его глаза молят хоть кого-то заступиться.", answers:[
    {text:"Ты становишься между толпой и жертвой, рискуя собственным телом.", guna:"sat", value:2},
    {text:"Ты проходишь мимо, делая вид, что это тебя не касается.", guna:"raj", value:0},
    {text:"Ты подхватываешь камень и бросаешь вместе со всеми, чувствуя азарт толпы.", guna:"tam", value:2},
  ]},
  { question: "На большом пире хозяин поднимает кубок и просит каждого сказать тост. Все ждут твоих слов.", answers:[
    {text:"Ты говоришь о благе и добре, о том, чтобы люди жили в мире и заботились друг о друге.", guna:"sat", value:2},
    {text:"Ты говоришь о победах, успехах и процветании, жаждая одобрения.", guna:"raj", value:1},
    {text:"Ты выкрикиваешь проклятия, призывая разрушить врагов и топить веселье в безумии.", guna:"tam", value:2},
  ]},
  { question: "Твой друг, отчаявшийся, просит у тебя взаймы — у него нет еды дома.", answers:[
    {text:"Ты даёшь деньги или еду, не требуя возврата.", guna:"sat", value:2},
    {text:"Ты даёшь с условием, что он вернёт в срок.", guna:"raj", value:1},
    {text:"Ты смеёшься ему в лицо и отворачиваешься.", guna:"tam", value:2},
  ]},
  { question: "На улице играет музыкант, его руки дрожат, но мелодия искренняя, наполненная душой. Люди проходят мимо.", answers:[
    {text:"Ты останавливаешься и слушаешь, позволяя музыке наполнить сердце.", guna:"sat", value:1},
    {text:"Ты кидаешь монету, если игра бодрит тебя, и идёшь дальше.", guna:"raj", value:1},
    {text:"Ты кричишь, чтобы он замолчал, потому что мешает твоим мыслям.", guna:"tam", value:2},
  ]},
  { question: "Маг подходит к тебе и протягивает свиток с запретным знанием. Его глаза сверкают тайной, а слова звучат соблазнительно.", answers:[
    {text:"Ты отказываешься: слишком опасно играть с силами, что выше человека.", guna:"sat", value:2},
    {text:"Ты берёшь свиток и читаешь осторожно, надеясь извлечь выгоду.", guna:"raj", value:1},
    {text:"Ты громко зачитываешь его на площади, наслаждаясь хаосом, который вызовешь.", guna:"tam", value:3},
  ]},
  { question: "Тебя приглашают быть судьёй в споре двух соседей. Оба горячо кричат, каждый считает себя правым.", answers:[
    {text:"Ты выслушиваешь и судишь справедливо, даже если это тяжело и непопулярно.", guna:"sat", value:3},
    {text:"Ты выносишь решение в пользу того, кто сильнее и богаче.", guna:"raj", value:2},
    {text:"Ты принимаешь сторону того, кто даст больше выгоды, смеясь над обманутым.", guna:"tam", value:2},
  ]},
  { question: "На перепутье дороги сидит нищий. Он протягивает руку, глаза его полны отчаяния.", answers:[
    {text:"Ты даёшь ему хлеб и молишься, чтобы он насытился.", guna:"sat", value:2},
    {text:"Ты кидаешь пару монет и спешишь дальше.", guna:"raj", value:1},
    {text:"Ты обзываешь его ленивым и уходишь, чувствуя презрение.", guna:"tam", value:2},
  ]},
  { question: "На твоём пути стоит пещера, вход её чёрный и глубокий, воздух вокруг тянет холодом. Люди говорят, что там сокрыты сокровища и тени прошлого.", answers:[
    {text:"Ты входишь осторожно, с молитвой в сердце и светильником в руках.", guna:"sat", value:1},
    {text:"Ты заходишь ради добычи, жадно ища золото и драгоценности.", guna:"raj", value:2},
    {text:"Ты бросаешься внутрь бездумно, наслаждаясь мраком и предвкушая хаос.", guna:"tam", value:2},
  ]},
  { question: "На перекрёстке стоит древняя статуя божества, покрытая мхом, будто забытая временем. Дороги расходятся в три стороны.", answers:[
    {text:"Ты кланяешься статуе и думаешь о вечном.", guna:"sat", value:1},
    {text:"Ты прикасаешься к подножию и просишь удачи в дороге.", guna:"raj", value:1},
    {text:"Ты плюёшь на камень и идёшь дальше, издеваясь над образом.", guna:"tam", value:3},
  ]},
  { question: "Река вышла из берегов, и чужой груз тонет в волнах. Доски и мешки несёт течением. Люди бегут мимо, спасая себя.", answers:[
    {text:"Ты бросаешься в воду, вытаскиваешь груз и возвращаешь хозяину.", guna:"sat", value:3},
    {text:"Ты вытаскиваешь, но прячешь для себя, жаждая наживы.", guna:"raj", value:2},
    {text:"Ты стоишь на берегу и смеёшься, наблюдая за гибелью чужого труда.", guna:"tam", value:2},
  ]},
  { question: "Твой враг повержен, он лежит у твоих ног, кровь капает из его ран, а в глазах — мольба о пощаде.", answers:[
    {text:"Ты отпускаешь его, позволив судьбе судить справедливо.", guna:"sat", value:3},
    {text:"Ты требуешь, чтобы он отдал всё имущество за свою жизнь.", guna:"raj", value:2},
    {text:"Ты добиваешь его со злорадной усмешкой.", guna:"tam", value:3},
  ]},
  { question: "Толпа собралась на площади, требуя крови преступника. Люди кричат, глаза горят яростью.", answers:[
    {text:"Ты становишься перед ними и умоляешь о милосердии, пытаясь разогнать гнев.", guna:"sat", value:2},
    {text:"Ты кричишь вместе с ними, чувствуя себя частью силы.", guna:"tam", value:2},
    {text:"Ты ждёшь момента, чтобы громко произнести речь ради собственной славы.", guna:"raj", value:1},
  ]},
  { question: "Ребёнок плачет из-за поломанной игрушки. Его мать в отчаянии.", answers:[
    {text:"Ты снимаешь со своего пояса амулет и отдаёшь ему, чтобы он снова улыбнулся.", guna:"sat", value:3},
    {text:"Ты покупаешь ему новую игрушку, ожидая благодарности.", guna:"raj", value:1},
    {text:"Ты берёшь его игрушку и ломаешь окончательно, смеясь.", guna:"tam", value:3},
  ]},
  { question: "Тебе предлагают два пути: один лёгкий, прямой, с цветами по обочинам; другой — трудный, каменистый, полный испытаний.", answers:[
    {text:"Ты выбираешь трудный путь, понимая, что только он ведёт к росту.", guna:"sat", value:2},
    {text:"Ты выбираешь лёгкий, но надеешься найти по дороге выгоду.", guna:"raj", value:2},
    {text:"Ты выбираешь тропу, где можно лечь и ничего не делать, лишь бы не трудиться.", guna:"tam", value:3},
  ]},
  { question: "Старец, чувствуя близкую смерть, спрашивает тебя: «Что главное в жизни?»", answers:[
    {text:"Ты отвечаешь: «Служение и любовь к другим».", guna:"sat", value:3},
    {text:"Ты отвечаешь: «Слава и память, что оставлю после себя».", guna:"raj", value:2},
    {text:"Ты отвечаешь: «Наслаждения, которые я успел вкусить».", guna:"tam", value:2},
  ]},
  { question: "Во сне к тебе приходит существо в сияющем одеянии и протягивает три дара. Первый — свиток знания, второй — жезл власти, третий — чаша забвения.", answers:[
    {text:"Ты берёшь свиток знания, принимая долг хранить мудрость.", guna:"sat", value:3},
    {text:"Ты берёшь жезл власти, чтобы подчинять и управлять.", guna:"raj", value:2},
    {text:"Ты берёшь чашу забвения и пьёшь, чтобы утонуть в пустоте.", guna:"tam", value:3},
  ]},
];

const GROUPS = {
  sat: {title:"Саттва — гармония", text:"Твоя природа — свет и ясность.", link:"https://t.me/+SNNjufNTtGJhMDI6"},
  raj: {title:"Раджас — действие", text:"Ты движим страстью и энергией.", link:"https://t.me/+B-mozvEpxM5kZjVi"},
  tam: {title:"Тамас — покой", text:"Тебе свойственна тяжесть и инерция.", link:"https://t.me/+K8aDzjYAsOg3Y2Fi"},
};

const app = {
  start: document.getElementById("screen-start"),
  quiz: document.getElementById("screen-quiz"),
  result: document.getElementById("screen-result"),
  btnStart: document.getElementById("btn-start"),
  btnRestart: document.getElementById("btn-restart"),
  qContainer: document.getElementById("question-container"),
  resultTitle: document.getElementById("result-title"),
  resultText: document.getElementById("result-text"),
  resultLink: document.getElementById("result-link"),
};

let state = {index:0, score:{sat:0,raj:0,tam:0}};

function showScreen(s){
  [app.start, app.quiz, app.result].forEach(x=>x.classList.remove("active"));
  s.classList.add("active");
}

function startQuiz(){
  state = {index:0, score:{sat:0,raj:0,tam:0}};
  showScreen(app.quiz);
  renderQuestion();
}

function renderQuestion(){
  const q = QUIZ[state.index];
  app.qContainer.innerHTML = `<h2>${q.question}</h2>`;
  q.answers.forEach(a=>{
    const btn = document.createElement("button");
    btn.className="answer";
    btn.textContent=a.text;
    btn.onclick=()=>selectAnswer(a);
    app.qContainer.appendChild(btn);
  });
}

function selectAnswer(a){
  state.score[a.guna]+=a.value;
  state.index++;
  if(state.index<QUIZ.length){
    renderQuestion();
  } else {
    finishQuiz();
  }
}

function finishQuiz(){
  let res = Object.entries(state.score).sort((a,b)=>b[1]-a[1])[0][0];
  let g = GROUPS[res];
  app.resultTitle.textContent=g.title;
  app.resultText.textContent=g.text;
  app.resultLink.href=g.link;
  showScreen(app.result);
}

app.btnStart.onclick=startQuiz;
app.btnRestart.onclick=()=>showScreen(app.start);
